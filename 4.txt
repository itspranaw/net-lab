CREATE TABLE STUDENT
( Usn VARCHAR(20),
Sname VARCHAR(20) NOT NULL,
Address VARCHAR(20),
Phone INT UNIQUE,
Gender VARCHAR(2),
CONSTRAINT usn_st_pk PRIMARY KEY(Usn)
);

CREATE TABLE SEMSEC
( Ssid INT,
Sem VARCHAR(5),
Sec VARCHAR(10),
CONSTRAINT semsec_ssid_pk PRIMARY KEY(Ssid)
);

CREATE TABLE SEMSEC
( Ssid INT,
Sem VARCHAR(5),
Sec VARCHAR(10),
CONSTRAINT semsec_ssid_pk PRIMARY KEY(Ssid)
);

SELECT S.Usn, S.Sname
FROM STUDENT S,SEMSEC M,CLASS C
WHERE M.Sem=4 AND M.Sec='c' AND S.Usn=C.Usn AND C.Ssid=M.Ssid;

SELECT C.Ssid AS Room_No, M.Sec AS Sec,M.Sem AS SEMESTER,
SUM(CASE WHEN S.Gender = 'M' THEN 1 ELSE 0 END) AS Male,
SUM(CASE WHEN S.Gender = 'F' THEN 1 ELSE 0 END) AS Female
FROM CLASS C ,STUDENT S,SEMSEC M
WHERE S.Usn=C.Usn AND M.Ssid=C.Ssid GROUP BY C.Ssid;

CREATE VIEW TEST1_MARK AS
SELECT Test1
FROM IAMARKS
WHERE Usn='4SN14CS001';

UPDATE IAMARKS
SET Finalia = (GREATEST(Test1+Test2,Test2+Test3,Test3+Test1)/2);

SELECT I.Usn, I.Test1,I.Test2,I.Test3,I.Finalia,
(CASE WHEN I.Finalia>=17 AND I.Finalia<=20 THEN 'Outstanding'
WHEN I.Finalia>=12 AND I.Finalia<17 THEN 'Average'
WHEN I.Finalia<12 THEN 'Weak'
ELSE 'INVALID'
END) AS Grade
FROM IAMARKS I,CLASS C,SEMSEC S
WHERE I.Usn=C.Usn AND C.Ssid=S.Ssid AND S.Sem=8 AND S.Sec IN ('A','B','C');
