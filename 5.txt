CREATE TABLE DEPARTMENT
( DNo INTEGER,
DName VARCHAR(20),
MgrSSN CHAR(9),
MgrStartDate DATE,
PRIMARY KEY(DNo)
);

CREATE TABLE EMPLOYEE
( SSN CHAR(9) PRIMARY KEY,
FName VARCHAR(20),
Minit CHAR,
LName VARCHAR(20),
Address VARCHAR(30),
Sex CHAR,
Salary DECIMAL(10,2),
SuperSSN CHAR(9),
DNo INTEGER,
CONSTRAINT SuperSSN_employee_fk FOREIGN KEY (SuperSSN) REFERENCES
EMPLOYEE(SSN),
CONSTRAINT dno_employee_fk FOREIGN KEY(DNo) REFERENCES
DEPARTMENT(DNo) ON DELETE CASCADE
);

CREATE TABLE DLOCATION
( DNo INTEGER,
DLoc VARCHAR(20),
PRIMARY KEY(DNo, DLoc),
CONSTRAINT dno_dlocation_fk FOREIGN KEY (DNo) REFERENCES
DEPARTMENT(DNo) ON DELETE CASCADE
);

CREATE TABLE PROJECT
( PNo INTEGER,
PName VARCHAR(20) UNIQUE,
PLocation VARCHAR(20),
DNo INTEGER,
PRIMARY KEY(PNo),
CONSTRAINT dno_project_fk FOREIGN KEY (DNo) REFERENCES
DEPARTMENT(DNo) ON DELETE CASCADE
);

CREATE TABLE WORKS_ON
( SSN CHAR(9),
PNo INTEGER,
Hours DECIMAL(3,1),
PRIMARY KEY(SSN,PNo),
CONSTRAINT ssn_workson_fk FOREIGN KEY (SSN) REFERENCES EMPLOYEE(SSN)
ON DELETE CASCADE,
CONSTRAINT pno_workson_fk FOREIGN KEY (PNo) REFERENCES PROJECT(PNo)
ON DELETE CASCADE
);


( SELECT DISTINCT P.PNo
FROM PROJECT P, DEPARTMENT D, EMPLOYEE E
WHERE E.DNo = D.DNo
AND D.MgrSSN = E.SSN
AND E.LName='Scott')
UNION
( SELECT DISTINCT P.PNo
FROM PROJECT P, WORKS_ON W, EMPLOYEE E
WHERE P.PNo = W.PNo AND E.SSN = W.SSN AND E.LName= 'Scott');

UPDATE EMPLOYEE
SET Salary= Salary * 1.1
WHERE SSN IN ( SELECT SSN
FROM PROJECT P, WORKS_ON W
WHERE P.PNo= W.PNo
AND P.PName=‘IoT’);

SELECT SUM(E.Salary),MAX(E.Salary),MIN(E.Salary),AVG(E.Salary)
FROM EMPLOYEE E JOIN DEPARTMENT D ON E.DNo=D.DNo
WHERE D.Dname='Accounts';

SELECT E.FName,E.LName
FROM EMPLOYEE E
WHERE NOT EXISTS ( SELECT P.PNo
FROM PROJECT P
WHERE P.DNo=5
AND P.PNo NOT IN ( SELECT W.PNo
FROM WORKS_ON W
WHERE W.SSN=E.SSN ));

SELECT E.DNo, COUNT(*)
FROM DEPARTMENT D,EMPLOYEE E
WHERE D.DNo=E.DNo
AND Salary> 600000
AND E.DNo IN ( SELECT DNo
FROM EMPLOYEE
GROUP BY DNo
HAVING COUNT(*)>5)
GROUP BY E.DNo
